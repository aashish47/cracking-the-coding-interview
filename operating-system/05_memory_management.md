# 05 Memory Management

## 1. Basics

- **Logical Address:** Generated by CPU (Virtual address).
- **Physical Address:** Actual location in RAM.
- **MMU (Memory Management Unit):** Hardware mapping Logical $\rightarrow$ Physical.

## 2. Contiguous Allocation

- **Fixed Partitioning:** Memory divided into fixed-size chunks.
    - _Issue:_ **Internal Fragmentation** (Process is smaller than partition).
- **Variable Partitioning:** Memory allocated exactly as needed.
    - _Issue:_ **External Fragmentation** (Total free space exists, but is not contiguous).
    - _Solution:_ Compaction (Defrag).

## 3. Paging (Non-Contiguous)

Solves External Fragmentation.

- **Frames:** Physical memory divided into fixed-size blocks.
- **Pages:** Logical memory divided into same-sized blocks.
- **Page Table:** Maps Page Number $\rightarrow$ Frame Number.
- **TLB (Translation Lookaside Buffer):** A hardware cache for the Page Table to speed up translation.

## 4. Segmentation

Divides memory based on logical units (Code, Stack, Heap, Data) rather than fixed size.

- Address: `<Segment-Number, Offset>`
- Solves internal fragmentation but suffers from external fragmentation.

## 5. Virtual Memory

Allows execution of processes that are not completely in memory. Illusion of infinite memory.

- **Demand Paging:** Load pages only when needed (Lazy Swapper).
- **Page Fault:** Accessing a page not currently in RAM.
    1.  Trap to OS.
    2.  Find page on disk (Swap space).
    3.  Bring into free frame.
    4.  Update Page Table.
    5.  Restart instruction.

- **Thrashing:** High paging activity. The system spends more time swapping pages than executing instructions. Occurs when degree of multiprogramming is too high (sum of working sets > physical memory).

## 6. Page Replacement Algorithms

When a page fault occurs and memory is full, we must swap out a victim page.

### 6.1 FIFO (First In First Out)

- Replace the oldest page.
- _Belady's Anomaly:_ Adding more frames can sometimes _increase_ page faults.

### 6.2 Optimal

- Replace the page that will not be used for the longest time.
- _Theoretical only_ (requires predicting the future). Used as a benchmark.

### 6.3 LRU (Least Recently Used)

- Replace the page that hasn't been used for the longest time.
- _Approximation of Optimal._ Good performance.
- _Implementation:_ Stack or Counter.

| Algorithm   | Pros               | Cons                                  |
| :---------- | :----------------- | :------------------------------------ |
| **FIFO**    | Simple.            | Belady's Anomaly, poor performance.   |
| **Optimal** | Lowest fault rate. | Impossible to implement.              |
| **LRU**     | Good performance.  | Hardware support required (overhead). |
